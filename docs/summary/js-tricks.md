# ğŸƒ JavaScript Tricks

## && ä¸ ||

```js
let flag = false;
let res = flag || new Date()
console.log(res)//Wed Mar 16 2022 22:19:32 GMT+0800 (ä¸­å›½æ ‡å‡†æ—¶é—´)

let flag2 = true;
let res2 = flag2 && "ideaå°æ—¶";
console.log(res2)//ideaå°æ—¶
```

å¦‚æœ||å‰é¢ä¸ºfalseï¼Œåˆ™è¿”å›åè€…ã€‚

å¦‚æœ&&å‰é¢ä¸ºtrueï¼Œåˆ™è¿”å›åè€…ã€‚



## varä¸let

```js
console.log(a)//undefined
var a=10;
```

```js
console.log(a)
let a=10;//Uncaught ReferenceError: Cannot access 'a' before initialization
```

varç±»å‹å˜é‡æœ‰ä¸ªç‰¹æ€§ï¼š**å£°æ˜æå‡**ã€‚å³ä¸ç®¡varå˜é‡åœ¨å“ªé‡Œå®šä¹‰ï¼Œéƒ½ä¼šåœ¨**å½“å‰ä»£ç å—æœ€å¼€å§‹çš„åœ°æ–¹**å£°æ˜å®ƒã€‚æ‰€ä»¥åœ¨å®ƒè¢«åˆå§‹åŒ–ä¹‹å‰ï¼Œå¯ä»¥æ‰“å°å®ƒï¼Œä½†æ˜¯åªèƒ½å¾—åˆ°undefinedã€‚

ä½†æ˜¯letæ²¡æœ‰è¿™ä¸ªç‰¹æ€§ï¼Œæ‰€ä»¥å®ƒæ˜¯ä¸€ä¸ªé”™è¯¯ã€‚



```js
for (let i = 0; i < 5; i++) {
    
}
console.log(i)//Uncaught ReferenceError: i is not defined
```

```js
for (var i = 0; i < 5; i++) {
    
}
console.log(i)//5
```

letå˜é‡çš„ä½œç”¨åŸŸå¾ˆæ˜ç¡®ï¼Œå°±æ˜¯å®šä¹‰ä»–çš„åœ°æ–¹ã€‚åœ¨forå¾ªç¯ä¹‹å¤–å°±è®¿é—®ä¸åˆ°äº†ã€‚

è€Œvarå˜é‡åˆæœ‰ä¸€ä¸ªç‰¹æ€§ï¼Œvarå®šä¹‰çš„å…¨å±€å˜é‡è‡ªåŠ¨ä¼šç»‘å®šåˆ°å…¨å±€å¯¹è±¡windowä¸Šã€‚

![window](../.vuepress/public/images/window.png)





## ä»»åŠ¡é˜Ÿåˆ—

```js
for (var i = 0; i < 5; i++) {
    setTimeout(()=>{
        console.log(i)
    },0)
}//5 5 5 5 5 
```

å³ä½¿è®¾ç½®äº†0msï¼ˆç«‹å³ï¼‰æ‰§è¡Œconsole.log(i)ï¼Œä½†æœ€ç»ˆè¿˜æ˜¯æ‰“å°äº†5ã€‚

å› ä¸ºJavaScriptæ˜¯å•çº¿ç¨‹çš„ï¼ŒsetTimeoutè¿™ç§è¡Œä¸ºï¼Œä¼šå°†é‡Œé¢çš„å‡½æ•°æ”¾åœ¨ä¸€ä¸ªä»»åŠ¡é˜Ÿåˆ—é‡Œï¼ŒJavaScriptå®Œæˆä¸»çº¿çš„ä»£ç ä¹‹åï¼Œæ‰ä¼šå»æ‰§è¡Œä»»åŠ¡é˜Ÿåˆ—é‡Œçš„ä»»åŠ¡ã€‚å› æ­¤ï¼Œå½“æ‰§è¡Œä»»åŠ¡é˜Ÿåˆ—é‡Œçš„ä»»åŠ¡æ—¶ï¼Œiå¾ªç¯å¢åŠ åˆ°äº†5ã€‚

å¹¶ä¸”ï¼ŒsetTimeoutåé¢è®¾ç½®çš„æ¯«ç§’æ•°ï¼Œæ˜¯æŒ‡ï¼šåœ¨å¤šå°‘msä¹‹åï¼ŒæŠŠé‡Œé¢çš„å‡½æ•°æ”¾è¿›ä»»åŠ¡é˜Ÿåˆ—é‡Œï¼Œå¹¶ä¸æ˜¯ç«‹å³æ‰§è¡Œï¼Œæ‰§è¡Œæ—¶é—´æ˜¯ä¸ç¡®å®šçš„ã€‚

åˆå› ä¸ºvaræ˜¯å…¨å±€å˜é‡ï¼Œæ‰€ä»¥æ‰“å°5çœ‹èµ·æ¥å¾ˆæ­£å¸¸ã€‚



é‚£ä¹ˆï¼ŒæŠŠvaræ”¹æˆletã€‚

```js
for (let i = 0; i < 5; i++) {
    setTimeout(()=>{
        console.log(i)
    },0)
}//0 1 2 3 4
```

è¿™æ—¶ï¼Œåˆä¼šæ‰“å°0 1 2 3 4ï¼Œè¿™åˆæ˜¯ä¸ºå•¥ï¼Ÿ

è¿™ä¸ªæ¶‰åŠåˆ°é—­åŒ…ã€‚

åœ¨  setTimeout( )å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬å†™äº†ä¸ªç®­å¤´å‡½æ•°ï¼Œç®­å¤´å‡½æ•°ä¸­è®¿é—®äº†åœ¨ç®­å¤´å‡½æ•°å¤–çš„ä½œç”¨åŸŸä¸­çš„å˜é‡iï¼Œå› æ­¤è¿™ä¸ªç®­å¤´å‡½æ•°å°±å¯ä»¥æˆä¸ºé—­åŒ…ã€‚

è€Œé—­åŒ…çš„ç‰¹æ€§æ˜¯ï¼Œä¼šä¸€ç›´æ‹¥æœ‰ä»–å¼•ç”¨çš„å˜é‡æ‰€åœ¨çš„è¯æ³•ä½œç”¨åŸŸã€‚

åœ¨è¿™é‡Œï¼Œç”¨letå£°æ˜çš„iï¼Œæ¯æ¬¡å¾ªç¯éƒ½ä¼šåˆ›å»ºä¸€ä¸ªé—­åŒ…ï¼Œé—­åŒ…å‡½æ•°å¼•ç”¨çš„iæ¯ä¸€æ¬¡å¾ªç¯éƒ½æ˜¯ä¸åŒçš„iï¼Œæ‰€ä»¥æ‰“å°0 1 2 3 4ã€‚

è€Œvarå£°æ˜çš„iï¼Œæ¯æ¬¡å¾ªç¯éƒ½ä¼šåˆ›å»ºä¸€ä¸ªé—­åŒ…ï¼Œä½†æ˜¯æ¯ä¸ªé—­åŒ…å‡½æ•°å¼•ç”¨çš„iæ˜¯å…¨å±€å˜é‡iï¼Œæ‰€ä»¥æ‰“å°å‡ºæ¥çš„ç»“æœæ˜¯ç›¸åŒçš„.

åŒºåˆ«å°±åœ¨äºï¼Œvarå£°æ˜çš„iæ˜¯åœ¨forå¾ªç¯å¤–é¢ï¼Œletæ˜¯åœ¨forå¾ªç¯å¼€å§‹çš„æ—¶å€™ã€‚

æœ‰äººå¯èƒ½ä¼šè¯´ï¼Œæ˜¯ä¸æ˜¯ä½ è®¾ç½®çš„æ—¶é—´å¤ªçŸ­äº†ï¼Œä½ è®¾ç½®æˆ1000msï¼Œç”¨letæ˜¯ä¸æ˜¯ä¹Ÿä¼šæ‰“å°5æ¬¡5ã€‚

äº‹å®ä¸Šï¼Œè¿˜æ˜¯ä¼šæ‰“å°0 1 2 3 4ã€‚å’Œæ—¶é—´æ²¡æœ‰å…³ç³»çš„ï¼Œä¸Šé¢è¯´è¿‡ï¼Œè¿™ä¸ªæ—¶é—´åªæ˜¯å°†å‡½æ•°æ”¾è¿›ä»»åŠ¡é˜Ÿåˆ—é‡Œçš„æ—¶é—´ã€‚

æ€»ç»“ä¸€å¥è¯ï¼šé—­åŒ…å‡½æ•°ä¼šä¸€ç›´æ‹¥æœ‰å…¶å¼•ç”¨å˜é‡æ‰€åœ¨çš„è¯æ³•ä½œç”¨åŸŸé“¾ã€‚



## IIFEï¼ˆç«‹å³è°ƒç”¨å‡½æ•°è¡¨è¾¾å¼ï¼‰

å¹³æ—¶æˆ‘ä»¬å®šä¹‰å’Œæ‰§è¡Œå‡½æ•°åˆ†ä¸ºä¸¤éƒ¨åˆ†ã€‚

```js
function test(){
    console.log(2)
}
test();
```

ä½¿ç”¨IIFEï¼ˆå‡½æ•°å¤–é¢å¥—ä¸ªæ‹¬å·ï¼Œç„¶åå†åœ¨åé¢åŠ ä¸ªæ‹¬å·ï¼‰ï¼šä¼šåœ¨å®šä¹‰çš„æ—¶å€™å°±æ‰§è¡Œå‡½æ•°

```js
(function test(){
    console.log(2)
})()
```



## ä¸è¦æ¢è¡Œï¼

```js
function addTwo(x) {
    return x + 2;
}

function addThree(x) {
    return x + 3;
}

function addFive(x) {
    return x + 5;
}

function addTen(x) {
    return
    Promise.
    resolve(x).
    then(addTwo).
    then(addThree).
    then(addFive);
}
addTen(10).then(console.log);
```

IDEæç¤ºï¼šUnreachable code

æœ‰é—®é¢˜å—ï¼Ÿæœ‰é—®é¢˜ã€‚

jsæ˜¯å¯¹å›è½¦æ•æ„Ÿçš„è¯­è¨€ï¼Œ**å¹¶ä¸æ˜¯é åˆ†å·æ¥åŒºåˆ†è¯­å¥çš„**ã€‚æ‰€ä»¥è¿™é‡Œæœ¬æ„æ˜¯æƒ³è®©ä»£ç æ›´ç¾è§‚ï¼ŒæŠŠreturnåé¢çš„å†…å®¹æ¢åˆ°äº†ä¸‹ä¸€è¡Œï¼Œä½†æ˜¯returnç‹¬å ä¸€è¡Œå°±ä¼šç›´æ¥è¿”å›äº†ã€‚

åº”è¯¥è¿™ä¹ˆå†™ï¼š

```js
function addTen(x) {
    return Promise.
    resolve(x). 
    then(addTwo).
    then(addThree).
    then(addFive);
}
```

## Array.prototype.reduce() æŒºå¥½ç©

```js
let res = [1, 2, 3, 4].reduce((pre, cur) => pre+cur, 10);
console.log(res)//20
//å³10+1,11+2ï¼Œ13+3,16+4
```

æ­¤å‡½æ•°å¯¹æ•°ç»„é‡Œçš„å…ƒç´ è¿›è¡Œå¾ªç¯ã€‚

reduceä¸­æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸ªå‡½æ•°ï¼ˆreducerå‡½æ•°ï¼‰ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯initialValueï¼ˆå¯é€‰çš„ï¼‰ã€‚

å¦‚æœä¸æä¾›initialValueï¼Œé‚£ä¹ˆå¾ªç¯å°†ä»ç¬¬äºŒä¸ªå…ƒç´ å¼€å§‹ã€‚

```js
let res = [1, 2, 3, 4].reduce((pre, cur) => pre+cur);
console.log(res)//10
//å³1+2+3+4
```

å¦‚æœæä¾›äº†åˆå§‹å€¼ï¼Œå°±ç›¸å½“äºåœ¨æ•°ç»„å‰é¢æ·»åŠ äº†åˆå§‹å€¼ã€‚

reducerå‡½æ•°ï¼Œæ¥æ”¶å››ä¸ªå‚æ•°ï¼š

pre:ä¸Šä¸€ä¸ªreducerå‡½æ•°çš„è¿”å›å€¼;ï¼ˆå¯¹äºä¸Šé¢çš„ä¾‹å­ï¼Œå°±æ˜¯return pre+curï¼‰

cur: å½“å‰éå†åˆ°çš„å…ƒç´ ã€‚

curIndex:å½“å‰éå†åˆ°çš„å…ƒç´ çš„ä¸‹æ ‡

arrï¼šè¢«éå†çš„å¯¹è±¡

å…·ä½“çš„è§£é‡Šåœ¨å®˜æ–¹æ–‡æ¡£é‡Œæœ‰ï¼š[Array.prototype.reduce()](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/Reduce)



## é€šç”¨çš„åˆæˆæœŸçº¦å‡½æ•°

å¯¹äºä¸‹é¢çš„ä»£ç ï¼Œæˆ‘åªèƒ½è¯´ï¼šjsç¥å¥‡ï¼

reduceå‡½æ•°æ˜¯ä¸€ä¸ªå¾ªç¯å¤„ç†çš„è¿‡ç¨‹ï¼Œå¾ªç¯ä¸€ä¸ªæ•°ç»„ï¼Œæ¥æ”¶ä¸€ä¸ªreducerå›è°ƒå‡½æ•°ï¼Œå¦‚æœå›è°ƒå‡½æ•°åªæœ‰ä¸¤ä¸ªå‚æ•°ï¼Œé‚£ä¹ˆç¬¬ä¸€ä¸ªå‚æ•°è¡¨ç¤ºpreviousValueï¼Œç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºcurrentValueï¼Œå›è°ƒå‡½æ•°ä¸­çš„è¿”å›å€¼å°±æ˜¯ä¸‹ä¸€æ¬¡æ“ä½œçš„previousValueã€‚

è¿™é‡Œçš„previousValueå°±æ˜¯promiseï¼Œå³promise.then(fn)æ‰§è¡Œåçš„è¿”å›å€¼ã€‚

å›è°ƒå‡½æ•°åé¢çš„promise.resolve(x)æ˜¯initialValueï¼ˆåˆå§‹å€¼ï¼‰ï¼Œè¢«å½“åšå¾ªç¯çš„ç¬¬ä¸€é¡¹ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šåˆå§‹å€¼ï¼Œåˆ™ä¼šå–æ•°ç»„çš„ç¬¬ä¸€é¡¹å½“åšinitialValueï¼Œä¹Ÿå°±æ˜¯è¯´å¾ªç¯ä»ç¬¬äºŒä¸ªå…ƒç´ å¼€å§‹ã€‚

fnå°±è¡¨ç¤ºæ•°ç»„ä¸­å½“å‰å¾ªç¯åˆ°çš„å€¼ã€‚

```js
function addTwo(x) {
    return x + 2;
}

function addThree(x) {
    return x + 3;
}

function addFive(x) {
    return x + 5;
}

// function addTen(x) {
//     return Promise.resolve(x).then(addTwo).then(addThree).then(addFive);
// }

// addTen(10).then(console.log);

// function addTen2(x) {
//     return [addTwo, addThree, addFive]
//         .reduce((promise, fn) => promise.then(fn), Promise.resolve(x))
// }

function compose(...fns) {
    return (x) => fns.reduce((promise, fn) => promise.then(fn), Promise.resolve(x))
}

let addTen = compose(addTwo, addThree, addFive)
addTen(11).then(console.log)
```



## == å’Œ === æ˜¯ä¸ä¸€æ ·çš„

==æ¯”è¾ƒçš„æ˜¯å€¼ã€‚ç±»ä¼¼äºJavaä¸­çš„equalsã€‚

===ä¸ä»…æ¯”è¾ƒå€¼ï¼Œè¿˜å¾—æ¯”è¾ƒç±»å‹ï¼Œç±»å‹ä¸ä¸€è‡´ä¹Ÿä¸è¡Œã€‚

é€šå¸¸IDEä¼šæ¨èä½¿ç”¨===ï¼Œä½¿ç”¨==ä¼šçˆ†å‡ºè­¦å‘Šã€‚

Numberï¼ˆxï¼‰è¿™ç§å’Œç›´æ¥å£°æ˜ä¸€æ ·ã€‚

```js
let a=3;
let b=new Number(3);
let c=3;
let d=Number(3);

console.log(a==b);//true
console.log(a===b);//false
console.log(a==c);//true
console.log(a===c);//true
console.log(a==d)//true
console.log(a===d)//true
console.log(b==d)//true
console.log(b===d)//false
```



